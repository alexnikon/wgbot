# nikonVPN Telegram Bot

Telegram –±–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ VPN –¥–æ—Å—Ç—É–ø–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π WGDashboard –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ Telegram Stars –∏ –ÆKassa.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–≥–æ—Ç–∞—Ä–∏—Ñ–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: 14 –¥–Ω–µ–π, 30 –¥–Ω–µ–π
- **–î–≤–∞ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã**: Telegram Stars –∏ –ÆKassa
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ VPN**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WGDashboard
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞

## üìã –¢–∞—Ä–∏—Ñ—ã

| –ü–µ—Ä–∏–æ–¥ | Telegram Stars | –ÆKassa |
|--------|----------------|--------|
| 14 –¥–Ω–µ–π | 100 Stars | 150 ‚ÇΩ |
| 30 –¥–Ω–µ–π | 200 Stars | 300 ‚ÇΩ |

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/alexnikon/wgbot.git
cd wgbot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
cp env.docker.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

### 3. –ó–∞–ø—É—Å–∫

```bash
docker-compose up -d
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ `goomboldt/wgbot:latest` –∏–∑ DockerHub

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```env
# Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# WGDashboard Configuration
WG_DASHBOARD_URL=http://your-wg-dashboard-url:10086
WG_DASHBOARD_API_KEY=your_wg_dashboard_api_key_here

# YooKassa Configuration
YOOKASSA_SHOP_ID=your_yookassa_shop_id_here
YOOKASSA_SECRET_KEY=your_yookassa_secret_key_here
YOOKASSA_PROVIDER_TOKEN=your_yookassa_provider_token_here

# Logging
LOG_LEVEL=INFO
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
   ```
   start - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
   buy - –ö—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø
   connect - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
   extend - –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø
   status - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
   ```

### WGDashboard

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ WGDashboard
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É URL

### –ÆKassa

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ [–ÆKassa](https://yookassa.ru/)
2. –ü–æ–ª—É—á–∏—Ç–µ Shop ID –∏ Secret Key
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ BotFather:
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots` –≤ BotFather
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
   - –ù–∞–∂–º–∏—Ç–µ "Bot Settings" ‚Üí "Payments"
   - –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ÆKassa
   - –ü–æ–ª—É—á–∏—Ç–µ Provider Token

## üöÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞
docker-compose pull
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
wgbot/
‚îú‚îÄ‚îÄ bot.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ database.py           # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ payment.py            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
‚îú‚îÄ‚îÄ utils.py              # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ wg_api.py             # API WGDashboard
‚îú‚îÄ‚îÄ run.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ env.docker.example    # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ wgdashboard_doc.txt   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è WGDashboard API
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –§–∞–π–ª `.env` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–¥ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- Read-only —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (512MB RAM, 0.5 CPU)

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

### –¢–∞–±–ª–∏—Ü–∞ `peers`
- `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `peer_name` - –ò–º—è –ø–∏—Ä–∞ (username_telegramID)
- `peer_id` - ID –ø–∏—Ä–∞ –≤ WGDashboard
- `job_id` - ID job –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
- `telegram_user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- `telegram_username` - Username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `expire_date` - –î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
- `is_active` - –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–∏—Ä
- `payment_status` - –°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã
- `stars_paid` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–≤–µ–∑–¥
- `last_payment_date` - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–ø–ª–∞—Ç—ã
- `notification_sent` - –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `tariff_key` - –ö–ª—é—á —Ç–∞—Ä–∏—Ñ–∞
- `payment_method` - –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
- `rub_paid` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ä—É–±–ª–µ–π

## üîÑ API WGDashboard

–ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å WGDashboard —á–µ—Ä–µ–∑ REST API:

- `POST /api/peers` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–∏—Ä–∞
- `GET /api/peers/{peer_id}/config` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `DELETE /api/peers/{peer_id}` - –£–¥–∞–ª–µ–Ω–∏–µ –ø–∏—Ä–∞
- `POST /api/savePeerScheduleJob` - –°–æ–∑–¥–∞–Ω–∏–µ job –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
- `DELETE /api/deletePeerScheduleJob` - –£–¥–∞–ª–µ–Ω–∏–µ job

## üí≥ –ü–ª–∞—Ç–µ–∂–∏

### Telegram Stars
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Telegram API
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### –ÆKassa
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –∫–∞—Ä—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- –ó–∞ 1 –¥–µ–Ω—å –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/wgbot.log`:
- –ó–∞–ø—É—Å–∫ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø–∏—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
docker-compose logs -f
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
docker exec -it wgbot sqlite3 /app/data/wgbot.db
.tables
SELECT * FROM peers;
```

---

**nikonVPN Telegram Bot** - –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ VPN –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ Telegram! üöÄ